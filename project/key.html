<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Caesar Cipher</title>
<style>
  body {
    font-family: Arial, sans-serif;
  }
  textarea {
    width: 100%;
    height: 100px;
    margin-bottom: 10px;
  }
</style>
</head>
<body>
<textarea id="messageInputKey" placeholder="Enter message"></textarea>
<input type="text" id="keyInputKey" placeholder="Enter key">
<select id="alphabetSelectKey">
  <option value="latin">Latin</option>
  <option value="cyrillic">Cyrillic</option>
</select>
<button onclick="encryptKey()">Encrypt</button>
<textarea id="resultKey" readonly></textarea>

<script>
const LATIN_ALPHABET_KEY = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
const CYRILLIC_ALPHABET_KEY = 'АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЬЮЯ';

function encryptKey() {
  var messageKey = document.getElementById('messageInputKey').value;
  var keyKey = document.getElementById('keyInputKey').value.toUpperCase();
  var alphabetTypeKey = document.getElementById('alphabetSelectKey').value;
  var alphabetKey = (alphabetTypeKey === 'latin') ? LATIN_ALPHABET_KEY : CYRILLIC_ALPHABET_KEY;

  var resultKey = '';
  var keyIndexKey = 0;
  for (var i = 0; i < messageKey.length; i++) {
    var charKey = messageKey.charAt(i);
    var charIndexKey = alphabetKey.indexOf(charKey.toUpperCase());
    if (charIndexKey !== -1) { // Check if it's a letter
      var shiftKey = alphabetKey.indexOf(keyKey.charAt(keyIndexKey).toUpperCase());
      var encryptedIndexKey = (charIndexKey + shiftKey) % alphabetKey.length;
      var encryptedCharKey = (charKey === charKey.toLowerCase()) ? alphabetKey.charAt(encryptedIndexKey).toLowerCase() : alphabetKey.charAt(encryptedIndexKey);
      resultKey += encryptedCharKey;
      keyIndexKey = (keyIndexKey + 1) % keyKey.length;
    } else {
      resultKey += charKey;
    }
  }
  
  document.getElementById('resultKey').value = resultKey;
}
</script>
</body>
</html>